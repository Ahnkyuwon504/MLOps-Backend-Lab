# kops install
curl -Lo kops https://github.com/kubernetes/kops/releases/download/$(curl -s https://api.github.com/repos/kubernetes/kops/releases/latest | grep tag_name | cut -d '"' -f 4)/kops-linux-amd64
chmod +x kops
sudo mv kops /usr/local/bin/kops

# aws cli util
sudo apt install awscli

# 확인
aws

# AWS/IAM/ADD USER/ADMINISTRATOR ACCESS 부여 -> 액세스 키 생성
# Key ID / Access Key / 리전:ap-northeast-2
aws configure

# 확인
ls -alh ~/.aws/

# AWS/S3/new bucket
이름: kops-state-kyu1
리전:ap-northeast-2

# AWS/Route53
# 도메인 등록->호스팅 영역 자동 생성 -> 네임서버 확인(DNS의 일부로, 도메인과 실제 서버 IP 주소 간의 매핑)

# 로그인 위해 ssh key 생성
ssh-keygen -t rsa -b 2048 -f ~/.ssh/test_key

# kubernetes 클러스터 생성
export NAME=kkyuu.com
export REGION="ap-northeast-2a"
export KOPS_STATE_STORE="s3://kops-state-kyu1"
export NODE_SIZE="t2.medium"

kops create cluster \
  --name=$NAME \
  --state=$KOPS_STATE_STORE \
  --zones=$REGION \
  --node-count=2 \
  --node-size=$NODE_SIZE \
  --control-plane-size=$NODE_SIZE \
  --dns-zone=$NAME

